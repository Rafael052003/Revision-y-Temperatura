<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chitré Selecto</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="./manifest.json">\n    <link rel="icon" href="./favicon.ico">
    <style>
        /* Estilos generales */
        :root {
            --primary-color: #111827;
            --secondary-color: #374151;
            --bg-light: #f4f5f7;
            --accent-green: #0A7456;
            --accent-red: #E34F4F;
            --highlight-yellow: #fff2b0;
            --highlight-green: #d4edda;
            --highlight-red: #f8d7da;
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-light);
            color: var(--primary-color);
            padding: 0;
        }
        .main-content {
            padding: 20px;
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
        }
        /* Estilo del Splash Screen */
        #splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-color);
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        #splash img {
            width: 120px;
            margin-bottom: 20px;
        }
        #splash h2 {
            font-weight: bold;
            font-size: 24px;
            margin-bottom: 10px;
        }
        #splash p {
            margin-top: 5px;
            font-size: 14px;
            opacity: 0.9;
        }
        header {
            text-align: center;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            position: relative;
            padding-left: 20px;
            padding-right: 20px;
        }
        .title-group {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .title-group h1 {
            font-size: 24px;
            font-weight: 700;
            margin: 2px 0;
            color: var(--primary-color);
            text-transform: uppercase;
        }
        @media (max-width: 600px) {
            .title-group h1 {
                font-size: 18px;
            }
        }
        .controls-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }
        .actions {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
        }
        .action-btn {
            background: var(--primary-color);
            color: white;
            border: 0;
            padding: 12px 24px;
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .action-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .action-btn.danger {
            background: var(--accent-red);
        }
        .action-btn.danger:hover {
            background: #dc2626;
        }
        .action-btn.green {
            background: var(--accent-green);
        }
        .action-btn.green:hover {
            background: #08664b;
        }
        .action-btn.blue {
            background: #3b82f6;
        }
        .action-btn.blue:hover {
            background: #2563eb;
        }
        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .chip {
            padding: 8px 16px;
            border-radius: 999px;
            cursor: pointer;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s ease-in-out;
            font-size: 14px;
        }
        .chip.active {
            background: var(--primary-color);
            color: white;
        }
        .table-container {
            overflow-x: auto;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border-radius: 8px;
        }
        .main-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 14px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        th, td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: center;
        }
        th {
            background: #f3f4f6;
            font-weight: 600;
            white-space: nowrap;
        }
        td.left {
            text-align: left;
        }
        th.product-sensitive {
            white-space: normal;
            line-height: 1.2;
        }
        input[type="number"], input[type="text"], input[type="tel"] {
            width: 100%;
            border: 0;
            text-align: center;
            background: transparent;
            font-size: 14px;
            padding: 2px;
            outline: none;
            transition: background-color 0.3s;
        }
        td[contenteditable="true"] {
            background: #fefce8;
        }
        .selected-row {
            background-color: #e0f7fa !important;
        }
        .initial-highlight {
            background-color: var(--highlight-yellow) !important;
        }
        .increased {
            background-color: var(--highlight-green) !important;
        }
        .decreased {
            background-color: var(--highlight-red) !important;
        }
        .toast-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column-reverse;
            gap: 10px;
            z-index: 1000;
        }
        .toast {
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(20px);
            animation: slideIn 0.5s forwards;
        }
        .toast.success {
            background-color: var(--accent-green);
        }
        .toast.warning {
            background-color: #ff9800;
        }
        .toast.error {
            background-color: var(--accent-red);
        }
        @keyframes slideIn {
            from{opacity:0;transform:translateY(20px);}
            to{opacity:1;transform:translateY(0);}
        }
        /* Estilos para el PDF/Impresión */
        @media print {
            @page { margin: 10mm; }
            body { padding: 0; font-family: 'Poppins', sans-serif; font-size: 12pt; }
            .container, header, .controls-container, .chips, .actions, .hamburger-btn, .side-menu, .overlay, .toast-container { display: none; }
            .printable-content { display: block !important; }
            .page-break { page-break-before: always; }
            .pdf-header { text-align: center; margin-bottom: 20px; }
            .pdf-header h1 { font-size: 20pt; margin: 2px 0; font-weight: 700; text-transform: uppercase; }
            .pdf-header p { font-size: 16pt; font-weight: bold; margin-top: 5px; text-align: center; }
            .pdf-section-title { text-align: center; font-size: 16pt; font-weight: 700; margin-top: 20px; text-transform: uppercase;}
            .main-table { 
                border-collapse: collapse; 
                margin: 10px auto; 
                font-size: 12pt; 
                table-layout: fixed; 
                width: 90%; 
            }
            th, td { border: 1px solid #333; padding: 8px; text-align: center; }
            th { background: #f0f0f0; font-weight: bold; }
            .initial-highlight, .increased, .decreased {
                background-color: transparent !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .pdf-footer { position: fixed; bottom: 20px; width: 100%; text-align: center; font-size: 16pt; font-weight: bold; color: #666; }
            .print-btn { display:none; }
            /* Anchos de columna específicos para cada tabla en PDF */
            /* Temperaturas */
            #temperaturas-tabla th:nth-child(1), #temperaturas-tabla td:nth-child(1) { width: 10%; }
            #temperaturas-tabla th:nth-child(2), #temperaturas-tabla td:nth-child(2) { width: 40%; text-align: left; }
            #temperaturas-tabla th:nth-child(3), #temperaturas-tabla td:nth-child(3) { width: 12.5%; }
            #temperaturas-tabla th:nth-child(4), #temperaturas-tabla td:nth-child(4) { width: 12.5%; }
            #temperaturas-tabla th:nth-child(5), #temperaturas-tabla td:nth-child(5) { width: 12.5%; }
            #temperaturas-tabla th:nth-child(6), #temperaturas-tabla td:nth-child(6) { width: 12.5%; }
            /* Revisiones */
            #revisiones-tabla th:nth-child(1), #revisiones-tabla td:nth-child(1) { width: 25%; text-align: left; }
            #revisiones-tabla th:nth-child(2), #revisiones-tabla td:nth-child(2) { width: 15%; }
            #revisiones-tabla th:nth-child(3), #revisiones-tabla td:nth-child(3) { width: 20%; }
            #revisiones-tabla th:nth-child(4), #revisiones-tabla td:nth-child(4) { width: 15%; }
            #revisiones-tabla th:nth-child(5), #revisiones-tabla td:nth-child(5) { width: 20%; }
            #revisiones-tabla th:nth-child(6), #revisiones-tabla td:nth-child(6) { width: 15%; }
        }
    </style>
</head>
<body>

    <div id="splash">
        <img src="https://via.placeholder.com/120" alt="Logo">
        <h2>REVISIÓN Y TEMPERATURA</h2>
        <p>Powered by Rafael Ramos</p>
        <p>Versión 1.0</p>
    </div>

    <div class="main-content container">
        <header>
            <div class="title-group">
                <h1>GRUPO RIBA SMITH</h1>
                <h1>R/S CHITRÉ SELECTO</h1>
                <h1 id="main-title">REVISIÓN DE INSTALACIONES</h1>
            </div>
        </header>

        <div class="controls-container">
            <div class="chips" id="chips"></div>
        </div>

        <div class="actions">
            <button id="btnAdd" class="action-btn"><i class="fas fa-plus"></i> Agregar Fila</button>
            <button id="btnExport" class="action-btn green"><i class="fas fa-file-pdf"></i> Generar PDF</button>
            <button id="btnClear" class="action-btn danger"><i class="fas fa-eraser"></i> Borrar Horarios</button>
            <button id="btnDeleteRow" class="action-btn danger"><i class="fas fa-trash-alt"></i> Eliminar Fila</button>
        </div>

        <div class="table-container" id="temperaturas-table-container">
            <table id="temperaturas-tabla" class="main-table">
                <thead>
                    <tr>
                        <th>TEMP</th>
                        <th class="left product-sensitive">NEVERAS</th>
                        <th>22:00</th>
                        <th>00:00</th>
                        <th>02:00</th>
                        <th>04:00</th>
                    </tr>
                </thead>
                <tbody id="temperaturas-tbody"></tbody>
            </table>
        </div>

        <div class="table-container" id="revisiones-table-container" style="display: none;">
            <table id="revisiones-tabla" class="main-table">
                <thead>
                    <tr>
                        <th>PUERTAS Y/O ÁREAS</th>
                        <th>REVISIÓN Nº1</th>
                        <th>OBSERVACIÓN</th>
                        <th>REVISIÓN Nº2</th>
                        <th>OBSERVACIÓN</th>
                        <th>REVISIÓN Nº3</th>
                        <th>OBSERVACIÓN</th>
                    </tr>
                </thead>
                <tbody id="revisiones-tbody"></tbody>
            </table>
        </div>

        <div id="toast" class="toast-container"></div>
    </div>

    <script>
        // Registrar Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('../service-worker.js')
                    .then(registration => {
                        console.log('Service Worker registrado con éxito:', registration);
                    })
                    .catch(error => {
                        console.log('Fallo en el registro de Service Worker:', error);
                    });
            });
        }

        (function () {
            const DEFAULT_SECCIONES = ['TEMPERATURAS', 'REVISIONES'];
            const STORAGE_KEY_TEMPERATURAS = 'data_temperaturas';
            const STORAGE_KEY_REVISIONES = 'data_revisiones';

            let dataTemperaturas = JSON.parse(localStorage.getItem(STORAGE_KEY_TEMPERATURAS));
            let dataRevisiones = JSON.parse(localStorage.getItem(STORAGE_KEY_REVISIONES));

            const initialTemperaturesData = [
                { temp: '-20°', nevera: 'NEVERA DE HIELOS' },
                { temp: '-23°', nevera: 'HELADERIA 1' },
                { temp: '-21°', nevera: 'HELADERIA 2' },
                { temp: '-20°', nevera: 'CONGELADOR HELADERIA 1' },
                { temp: '5°', nevera: 'NEVERA HELADERIA 1' },
                { temp: '-20°', nevera: 'CONGELADOR HELADERIA 2' },
                { temp: '5°', nevera: 'NEVERA HELADERIA 2' },
                { temp: '5°', nevera: 'NEVERA DE SODAS' },
                { temp: '-22°', nevera: 'HELADOS 1' },
                { temp: '-22°', nevera: 'HELADOS 2' },
                { temp: '-24°', nevera: 'H. IMPORTADOS' },
                { temp: '-25°', nevera: 'NEVERA PAPAS FRITAS' },
                { temp: '-21°', nevera: 'PANES CONGELADOS' },
                { temp: '-25°', nevera: 'MARISCOS CONGELADOS' },
                { temp: '-21°', nevera: 'TORTILLAS CONGELADAS 1' },
                { temp: '-25°', nevera: 'TORTILLAS CONGELADAS 2' },
                { temp: '5°', nevera: 'NEVERA PANADERIA' },
                { temp: '-20°', nevera: 'CONGELADOR PANADERIA' },
                { temp: '3°', nevera: 'NEVERA CERVEZAS' },
                { temp: '3°', nevera: 'NEVERA PRODUCTOS RIMITH' },
                { temp: '4°', nevera: 'NEVERA LACTEOS RIMITH' },
                { temp: '4°', nevera: 'NEVERA EMBUTIDOS RIMITH' },
                { temp: '2°', nevera: 'NEVERA QUESOS RIMITH' },
                { temp: '4°', nevera: 'NEVERAS CARNES EMPACADAS' },
                { temp: '6°', nevera: 'NEVERA HUEVOS' },
                { temp: '4°', nevera: 'NEVERA EMBUTIDOS' },
                { temp: '5°', nevera: 'NEVERA AREPAS' },
                { temp: '4°', nevera: 'NEVERA FRUTAS' },
                { temp: '5°', nevera: 'NEVERA FRUTAS ENVASADAS' },
                { temp: '3°', nevera: 'TORTILLAS RIMITH' },
                { temp: '2°', nevera: 'NEVERA YOGURT' },
                { temp: '4°', nevera: 'NEVERA JUGOS' },
                { temp: '5°', nevera: 'NEVERA MANZANAS' },
                { temp: '5°', nevera: 'NEVERA LEGUMBRES' },
                { temp: '4°', nevera: 'NEVERA FLORES' },
                { temp: '3°', nevera: 'NEVERAS POLLO (CARNICERIA)' },
                { temp: '3°', nevera: 'NEVERAS CARNES (CARNICERIA)' },
                { temp: '3°', nevera: 'NEVERA EMBUTIDOS (CARNICERIA)' },
                { temp: '4°', nevera: 'CUARTO FRIO MEZANINE' },
                { temp: '4°', nevera: 'CUARTO FRIO RECIBO' },
                { temp: '-20°', nevera: 'CONGELADOR RECIBO' },
            ];

            const initialRevisionesData = [
                { area: 'PUERTA DE LADO DEL HOTEL' },
                { area: 'PUERTA DE SALIDA PRINCIPAL' },
                { area: 'PUERTA DE VIVERO' },
                { area: 'PUERTA DE RECIBO' },
                { area: 'PUERTA DE SANIDAD' },
                { area: 'PUERTA DEL COMEDOR' },
                { area: 'PUERTA DE DECORACIÓN' },
                { area: 'PUERTA DE BACK OFFICE' },
                { area: 'PUERTA OFICINA LIC MELISSA' },
                { area: 'PUERTA DE SERVIDORES' },
                { area: 'PUERTA DE SEGURIDAD' },
                { area: 'PUERTA DE BÓVEDA' },
            ];

            if (!dataTemperaturas || dataTemperaturas.length === 0 || !dataTemperaturas[0].nevera) {
                dataTemperaturas = initialTemperaturesData.map(item => ({
                    ...item,
                    t2200: '',
                    t0000: '',
                    t0200: '',
                    t0400: ''
                }));
            }

            if (!dataRevisiones || dataRevisiones.length === 0 || !dataRevisiones[0].area) {
                dataRevisiones = initialRevisionesData.map(item => ({
                    ...item,
                    rev1: '',
                    obs1: '',
                    rev2: '',
                    obs2: '',
                    rev3: '',
                    obs3: ''
                }));
            }

            let seccionActiva = DEFAULT_SECCIONES[0];
            let selectedRow = null;

            const chipsEl = document.getElementById('chips');
            const btnExport = document.getElementById('btnExport');
            const btnClear = document.getElementById('btnClear');
            const btnAdd = document.getElementById('btnAdd');
            const btnDeleteRow = document.getElementById('btnDeleteRow');
            const toastContainer = document.getElementById('toast');
            const mainTitle = document.getElementById('main-title');
            const temperaturasTableContainer = document.getElementById('temperaturas-table-container');
            const revisionesTableContainer = document.getElementById('revisiones-table-container');

            window.addEventListener("load", () => {
                setTimeout(() => {
                    document.getElementById("splash").style.opacity = "0";
                }, 1500);
                setTimeout(() => {
                    document.getElementById("splash").style.display = "none";
                }, 2000);
            });

            function save() {
                localStorage.setItem(STORAGE_KEY_TEMPERATURAS, JSON.stringify(dataTemperaturas));
                localStorage.setItem(STORAGE_KEY_REVISIONES, JSON.stringify(dataRevisiones));
            }

            function showToast(msg, type = 'success') {
                const t = document.createElement('div');
                t.className = `toast ${type}`;
                t.textContent = msg;
                toastContainer.appendChild(t);
                setTimeout(() => {
                    t.style.opacity = '0';
                    t.style.transform = 'translateY(20px)';
                    setTimeout(() => t.remove(), 500);
                }, 2000);
            }

            function renderChips() {
                chipsEl.innerHTML = '';
                DEFAULT_SECCIONES.forEach(s => {
                    const b = document.createElement('div');
                    b.className = 'chip' + (s === seccionActiva ? ' active' : '');
                    b.textContent = s;
                    b.onclick = () => {
                        seccionActiva = s;
                        render();
                    };
                    chipsEl.appendChild(b);
                });
            }

            function render() {
                renderChips();
                selectedRow = null;
                let dataToRender;
                let tbody;
                let tableContainer;
                let title;

                if (seccionActiva === 'TEMPERATURAS') {
                    dataToRender = dataTemperaturas;
                    tbody = document.getElementById('temperaturas-tbody');
                    tableContainer = temperaturasTableContainer;
                    title = 'REVISIÓN DE TEMPERATURAS';
                    revisionesTableContainer.style.display = 'none';
                } else {
                    dataToRender = dataRevisiones;
                    tbody = document.getElementById('revisiones-tbody');
                    tableContainer = revisionesTableContainer;
                    title = 'REVISIÓN DE INSTALACIONES';
                    temperaturasTableContainer.style.display = 'none';
                }

                mainTitle.textContent = title;
                tableContainer.style.display = 'block';
                tbody.innerHTML = '';

                if (!dataToRender.length) {
                    tbody.innerHTML = '<tr><td colspan="7" style="color:#666;text-align:center;padding:20px;">Sin datos en esta sección.</td></tr>';
                    return;
                }

                dataToRender.forEach((item, index) => {
                    const tr = document.createElement('tr');
                    if (seccionActiva === 'TEMPERATURAS') {
                        tr.innerHTML = `
                            <td contenteditable="true" data-field="temp">${item.temp || ''}</td>
                            <td class="left" contenteditable="true" data-field="nevera">${item.nevera || ''}</td>
                            <td><input type="number" data-field="t2200" value="${item.t2200 || ''}"></td>
                            <td><input type="number" data-field="t0000" value="${item.t0000 || ''}"></td>
                            <td><input type="number" data-field="t0200" value="${item.t0200 || ''}"></td>
                            <td><input type="number" data-field="t0400" value="${item.t0400 || ''}"></td>
                        `;
                    } else {
                        tr.innerHTML = `
                            <td contenteditable="true" data-field="area">${item.area || ''}</td>
                            <td><input type="text" data-field="rev1" value="${item.rev1 || ''}"></td>
                            <td><input type="text" data-field="obs1" value="${item.obs1 || ''}"></td>
                            <td><input type="text" data-field="rev2" value="${item.rev2 || ''}"></td>
                            <td><input type="text" data-field="obs2" value="${item.obs2 || ''}"></td>
                            <td><input type="text" data-field="rev3" value="${item.rev3 || ''}"></td>
                            <td><input type="text" data-field="obs3" value="${item.obs3 || ''}"></td>
                        `;
                    }

                    tr.querySelectorAll('[contenteditable="true"]').forEach(td => {
                        td.addEventListener('input', () => {
                            const field = td.dataset.field;
                            dataToRender[index][field] = td.innerText.trim();
                            save();
                        });
                    });

                    tr.querySelectorAll('input').forEach((inp) => {
                        inp.addEventListener('input', () => {
                            const field = inp.dataset.field;
                            dataToRender[index][field] = inp.value.trim();
                            save();
                        });
                    });

                    tr.addEventListener('click', () => {
                        if (selectedRow) selectedRow.classList.remove('selected-row');
                        selectedRow = tr;
                        selectedRow.classList.add('selected-row');
                    });

                    tbody.appendChild(tr);
                });
            }

            btnAdd.onclick = () => {
                let newData;
                if (seccionActiva === 'TEMPERATURAS') {
                    newData = { temp: '', nevera: '', t2200: '', t0000: '', t0200: '', t0400: '' };
                    dataTemperaturas.push(newData);
                } else {
                    newData = { area: '', rev1: '', obs1: '', rev2: '', obs2: '', rev3: '', obs3: '' };
                    dataRevisiones.push(newData);
                }
                save();
                render();
                showToast('Fila agregada.', 'success');
            };

            btnDeleteRow.onclick = () => {
                if (!selectedRow) {
                    showToast('Selecciona una fila.', 'error');
                    return;
                }

                if (confirm('¿Eliminar esta fila?')) {
                    const index = Array.from(selectedRow.parentNode.children).indexOf(selectedRow);
                    if (seccionActiva === 'TEMPERATURAS') {
                        dataTemperaturas.splice(index, 1);
                    } else {
                        dataRevisiones.splice(index, 1);
                    }
                    save();
                    render();
                    showToast('Fila eliminada.', 'success');
                }
            };

            btnClear.onclick = () => {
                if (confirm('¿Borrar todos los datos de esta sección?')) {
                    if (seccionActiva === 'TEMPERATURAS') {
                        dataTemperaturas = initialTemperaturesData.map(item => ({
                            ...item,
                            t2200: '',
                            t0000: '',
                            t0200: '',
                            t0400: ''
                        }));
                    } else {
                        dataRevisiones = initialRevisionesData.map(item => ({
                            ...item,
                            rev1: '',
                            obs1: '',
                            rev2: '',
                            obs2: '',
                            rev3: '',
                            obs3: ''
                        }));
                    }
                    save();
                    render();
                    showToast('Datos borrados.', 'success');
                }
            };

            btnExport.onclick = () => {
                const dataTemp = dataTemperaturas;
                const dataRev = dataRevisiones;

                if (!dataTemp.length && !dataRev.length) {
                    showToast('No hay datos para exportar', 'warning');
                    return;
                }

                let html = `
                <html>
                <head>
                    <title>Reporte Riba Smith</title>
                    <style>
                        body { font-family: Arial, sans-serif; font-size: 12px; margin: 30px; color: #111; }
                        h1, h2, h3 { margin: 5px 0; text-align: center; }
                        .header { text-align: center; margin-bottom: 20px; }
                        .header h1 { font-size: 20px; font-weight: bold; }
                        .header h2 { font-size: 16px; }
                        .header p { margin: 2px 0; }
                        table { 
                            width: 90%;
                            border-collapse: collapse; 
                            margin: 15px auto;
                        }
                        th, td { border: 1px solid #444; padding: 6px; text-align: center; font-size: 11px; }
                        th { background: #f3f4f6; font-weight: bold; }
                        tr:nth-child(even) td { background: #fafafa; }
                        .section-title { margin-top: 25px; font-size: 14px; font-weight: bold; text-align: left; }
                        .footer { text-align: center; margin-top: 30px; font-weight: bold; font-size: 12px; }
                        .page-break { page-break-before: always; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>GRUPO RIBA SMITH</h1>
                        <h2>R/S CHITRÉ SELECTO</h2>
                        <p>REVISIÓN DE INSTALACIONES Y TEMPERATURAS DE NEVERAS</p>
                        <p><b>Fecha:</b> ${new Date().toLocaleDateString("es-ES")}</p>
                    </div>
                `;

                if (dataTemp.length) {
                    html += `
                    <div class="section-title">TEMPERATURAS</div>
                    <table>
                        <thead>
                            <tr>
                                <th>TEMP</th>
                                <th>NEVERAS</th>
                                <th>22:00</th>
                                <th>00:00</th>
                                <th>02:00</th>
                                <th>04:00</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    dataTemp.forEach(d => {
                        html += `
                            <tr>
                                <td>${d.temp || ""}</td>
                                <td>${d.nevera || ""}</td>
                                <td>${d.t2200 || ""}</td>
                                <td>${d.t0000 || ""}</td>
                                <td>${d.t0200 || ""}</td>
                                <td>${d.t0400 || ""}</td>
                            </tr>`;
                    });
                    html += `</tbody></table>`;
                }

                if (dataRev.length) {
                    if (dataTemp.length) {
                        html += `<div class="page-break"></div>`;
                    }
                    html += `
                    <div class="section-title">REVISIONES</div>
                    <table>
                        <thead>
                            <tr>
                                <th>PUERTAS Y/O ÁREAS</th>
                                <th>REVISIÓN Nº1</th>
                                <th>OBSERVACIÓN</th>
                                <th>REVISIÓN Nº2</th>
                                <th>OBSERVACIÓN</th>
                                <th>REVISIÓN Nº3</th>
                                <th>OBSERVACIÓN</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    dataRev.forEach(d => {
                        html += `
                            <tr>
                                <td>${d.area || ""}</td>
                                <td>${d.rev1 || ""}</td>
                                <td>${d.obs1 || ""}</td>
                                <td>${d.rev2 || ""}</td>
                                <td>${d.obs2 || ""}</td>
                                <td>${d.rev3 || ""}</td>
                                <td>${d.obs3 || ""}</td>
                            </tr>`;
                    });
                    html += `</tbody></table>`;
                }

                html += `<div class="footer">Powered by Rafael Ramos</div>`;
                html += `</body></html>`;

                const win = window.open("", "_blank");
                win.document.write(html);
                win.document.close();
                win.focus();
                setTimeout(() => win.print(), 500);
            };

            render();
        })();
    </script>
</body>
</html>
